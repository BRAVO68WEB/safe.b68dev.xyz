{"version":3,"sources":["auth.js"],"names":["const","lsKeys","token","page","localStorage","user","pass","do","dest","trigger","value","trim","swal","classList","add","axios","post","username","password","then","response","data","success","remove","description","window","location","catch","error","console","verify","onload","document","querySelector","addEventListener","event","preventDefault","currentTarget"],"mappings":"AAEAA,IAAMC,OAAS,CACbC,MAAO,SAGHC,KAAO,CAEXD,MAAOE,aAAaH,OAAOC,OAG3BG,KAAM,KACNC,KAAM,KAGRC,GAAO,SAAIC,EAAMC,GACfT,IAAMK,EAAOF,KAAKE,KAAKK,MAAMC,OAC7B,IAAKN,EACH,OAAOO,KAAK,qBAAsB,kCAAmC,SAEvEZ,IAAMM,EAAOH,KAAKG,KAAKI,MAAMC,OAC7B,IAAKL,EACH,OAAOM,KAAK,qBAAsB,kCAAmC,SAEvEH,EAAQI,UAAUC,IAAI,cACtBC,MAAMC,KAAK,OAAOR,EAAQ,CACxBS,SAAUZ,EACVa,SAAUZ,IACTa,MAAI,SAACC,GACN,IAA8B,IAA1BA,EAASC,KAAKC,QAEhB,OADAb,EAAQI,UAAUU,OAAO,cAClBX,KAAK,aAAaJ,EAAI,IAAKY,EAASC,KAAKG,YAAa,SAG/DpB,aAAaF,MAAQkB,EAASC,KAAKnB,MACnCuB,OAAOC,SAAW,eACjBC,OAAK,SAACC,GAGP,OAFAC,QAAQD,MAAMA,GACdnB,EAAQI,UAAUU,OAAO,cAClBX,KAAK,qBAAsB,sFAAuF,aAI7HkB,OAAW,WACJ3B,KAAKD,OAEVa,MAAMC,KAAK,oBAAqB,CAC9Bd,MAAOC,KAAKD,QACXiB,MAAI,SAACC,GACN,IAA8B,IAA1BA,EAASC,KAAKC,QAChB,OAAOV,KAAK,qBAAsBQ,EAASC,KAAKG,YAAa,SAE/DC,OAAOC,SAAW,eACjBC,OAAK,SAACC,GACPC,QAAQD,MAAMA,GACd5B,IAAMwB,EAAcI,EAAMR,SAASC,MAAQO,EAAMR,SAASC,KAAKG,YAC3DI,EAAMR,SAASC,KAAKG,YACpB,sFACJ,OAAOZ,KAAQgB,EAAMR,SAAS,OAAM,IAAIQ,EAAMR,SAAmB,WAAII,EAAa,cAItFC,OAAOM,OAAM,WACX5B,KAAK2B,SAEL3B,KAAKE,KAAO2B,SAASC,cAAc,SACnC9B,KAAKG,KAAO0B,SAASC,cAAc,SAGnCD,SAASC,cAAc,aAAaC,iBAAiB,UAAQ,SAAEC,GAC7DA,EAAMC,oBAGRJ,SAASC,cAAc,aAAaC,iBAAiB,SAAO,SAAEC,GAC5DhC,KAAKI,GAAG,QAAS4B,EAAME,kBAGzBL,SAASC,cAAc,gBAAgBC,iBAAiB,SAAO,SAAEC,GAC/DhC,KAAKI,GAAG,WAAY4B,EAAME","file":"auth.js","sourcesContent":["/* global swal, axios */\n\nconst lsKeys = {\n  token: 'token'\n}\n\nconst page = {\n  // user token\n  token: localStorage[lsKeys.token],\n\n  // HTML elements\n  user: null,\n  pass: null\n}\n\npage.do = (dest, trigger) => {\n  const user = page.user.value.trim()\n  if (!user)\n    return swal('An error occurred!', 'You need to specify a username.', 'error')\n\n  const pass = page.pass.value.trim()\n  if (!pass)\n    return swal('An error occurred!', 'You need to specify a password.', 'error')\n\n  trigger.classList.add('is-loading')\n  axios.post(`api/${dest}`, {\n    username: user,\n    password: pass\n  }).then(response => {\n    if (response.data.success === false) {\n      trigger.classList.remove('is-loading')\n      return swal(`Unable to ${dest}!`, response.data.description, 'error')\n    }\n\n    localStorage.token = response.data.token\n    window.location = 'dashboard'\n  }).catch(error => {\n    console.error(error)\n    trigger.classList.remove('is-loading')\n    return swal('An error occurred!', 'There was an error with the request, please check the console for more information.', 'error')\n  })\n}\n\npage.verify = () => {\n  if (!page.token) return\n\n  axios.post('api/tokens/verify', {\n    token: page.token\n  }).then(response => {\n    if (response.data.success === false)\n      return swal('An error occurred!', response.data.description, 'error')\n\n    window.location = 'dashboard'\n  }).catch(error => {\n    console.error(error)\n    const description = error.response.data && error.response.data.description\n      ? error.response.data.description\n      : 'There was an error with the request, please check the console for more information.'\n    return swal(`${error.response.status} ${error.response.statusText}`, description, 'error')\n  })\n}\n\nwindow.onload = () => {\n  page.verify()\n\n  page.user = document.querySelector('#user')\n  page.pass = document.querySelector('#pass')\n\n  // Prevent default form's submit action\n  document.querySelector('#authForm').addEventListener('submit', event => {\n    event.preventDefault()\n  })\n\n  document.querySelector('#loginBtn').addEventListener('click', event => {\n    page.do('login', event.currentTarget)\n  })\n\n  document.querySelector('#registerBtn').addEventListener('click', event => {\n    page.do('register', event.currentTarget)\n  })\n}\n"]}